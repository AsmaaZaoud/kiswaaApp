load(
    "//tools/build_defs/oss:rn_defs.bzl",
    "ANDROID",
    "APPLE",
    "CXX",
    "fb_xplat_cxx_test",
    "react_native_xplat_target",
)

<<<<<<< HEAD
=======
TEST_SRCS = [
    "RecoverableErrorTest.cpp",
    "jsarg_helpers.cpp",
    "jsbigstring.cpp",
    "methodcall.cpp",
]

jni_instrumentation_test_lib(
    name = "tests",
    srcs = TEST_SRCS,
    class_under_test = "com/facebook/react/XplatBridgeTest",
    compiler_flags = [
        "-fexceptions",
        "-frtti",
        "-std=c++17",
    ],
    soname = "libxplat-bridge.so",
    visibility = [
        "//fbandroid/instrumentation_tests/...",
    ],
    deps = [
        "//xplat/folly:dynamic",
        "//xplat/third-party/gmock:gtest",
        "//xplat/third-party/linker_lib:android",
        "//xplat/third-party/linker_lib:atomic",
        react_native_xplat_target("cxxreact:bridge"),
        react_native_xplat_target("cxxreact:jsbigstring"),
    ],
)

>>>>>>> main
fb_xplat_cxx_test(
    name = "tests",
    srcs = glob(["*.cpp"]),
    compiler_flags = [
        "-fexceptions",
        "-frtti",
    ],
    contacts = ["oncall+react_native@xmail.facebook.com"],
    platforms = (ANDROID, APPLE, CXX),
    visibility = [
        react_native_xplat_target("cxxreact/..."),
    ],
    deps = [
        "//xplat/folly:init_init",
        "//xplat/third-party/gmock:gtest",
        react_native_xplat_target("cxxreact:bridge"),
        react_native_xplat_target("cxxreact:jsbigstring"),
    ],
)
